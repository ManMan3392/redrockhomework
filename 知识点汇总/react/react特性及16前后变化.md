# react特性及16前后变化
## react主要特性
1. ### 组件化开发       
    一个组件是 UI（用户界面）的一部分，它拥有自己的逻辑和外观。可复用。
2. ### JSX（JavaScript XML）
   React认为渲染逻辑本质上与其他UI逻辑存在内在耦合。故而出现JSX。
   可以在 JS 中写 HTML 结构。JSX 会被 Babel 编译为 React.createElement() 调用。
3. ### 单向数据流
   数据自上而下流动（从父组件传到子组件），利于数据的可控性和调试。
4. ### 虚拟 DOM（Virtual DOM）
   React 会先构建一个组件对应的虚拟 DOM 树（在内存中），每次状态变更时，先在虚拟 DOM 上进行 diff 操作，再映射到真实 DOM，提高性能。
5. ### 声明式编程
   描述“做什么”而非“怎么做”。你不需要直接进行DOM操作，就可以从手动更改DOM、属性操作、事件处理中解放出来；
## React 的 Diff 算法
用于比较更新前后的虚拟 DOM 树，找出差异部分进行最小化更新。
React利用ReactElement对象组成了一个**JavaScript的对象树**，就是**虚拟DOM（Virtual DOM）**。t在props或state发生改变时ReactDOM.render让虚拟DOM和真实DOM同步，这个过程中叫做协调（Reconciliation）。
在diff算法中：同层节点之间相互比较，不会跨节点比较。如果节点类型不同，产生不同的树结构。可以通过key来指定哪些节点在不同的渲染下保持稳定：
1. 先遍历旧子节点，构建 key -> 节点 的 Map；
2. 再遍历新子节点，查找是否能复用旧节点；
3. 匹配不到则插入新节点，匹配到了则移动或更新。
## Fiber 架构（React 16+）
React Fiber 是 React 16 引入的全新协调（Reconciliation）引擎，目的是为了更好地支持异步渲染、提高可中断性。他将渲染更新任务拆分成多个小任务，在每一帧中增量执行，且可以中断和恢复渲染过程。
每一个 Fiber 对象都是组件（或元素）在虚拟 DOM 中的一个节点，它是一个 JS 对象，包含了丰富的状态信息。
React 会在内存中维护两棵 Fiber 树：
1. current：当前页面显示的 Fiber 树。
2. workInProgress：这次更新的新树，构建完毕后切换为 current。
## react16前后对比：
| 特性/版本    | React 16 之前            | React 16（Fiber）之后                |
| ------------ | ------------------------ | ------------------------------------ |
| 渲染过程     | 同步递归，不能中断       | 可中断、增量、优先级调度的 Fiber 树  |
| 错误处理     | 一处出错，整个页面崩溃   | 引入 Error Boundaries，局部处理错误  |
| 渲染能力     | 无法中断、低优先级响应慢 | 可打断任务，响应用户更及时           |
| 支持的功能   | 基础渲染                 | 支持 Suspense、Concurrent Mode 等    |
| 内部数据结构 | 虚拟 DOM 树              | Fiber 树（链表结构，能记录更多信息） |

(表格来源于gpt的大力支持)
